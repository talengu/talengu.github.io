<!doctype html><html class="theme-next pisces use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/public/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/public/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/public/css/main.css?v=5.1.0" rel="stylesheet" type="text/css"><meta name="keywords" content="转载,"><link rel="alternate" href="/public/atom.xml" title="一塘" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/public/images/favicon_blog.png?v=5.1.0"><meta name="description" content="「转」创建自己的第一个 Power Automate 工作流，从此繁琐操作是路人"><meta name="keywords" content="转载"><meta property="og:type" content="article"><meta property="og:title" content="「转」创建自己的第一个 Power Automate 工作流，从此繁琐操作是路人"><meta property="og:url" content="https://talengu.github.io/2022/07/15/test/202207/2022-07-06-112955648077/index.html"><meta property="og:site_name" content="一塘"><meta property="og:description" content="「转」创建自己的第一个 Power Automate 工作流，从此繁琐操作是路人"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/de8c3fa824294bf25c005ee739b6fa16.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/e72489a744d32d7ee2c1d05c33c99750.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/ff2858560d6a1910cbe192c22f5ea5b0.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/262d41483b5554d336ceeb7b48bf4737.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/6cba21a8d0780a742d20350c99fcb0d8.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/ef2cc4d9b12be06a30cdcafb348ec208.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/a991d2d9c0d5881c937bef77110c7fc3.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/aa58f992a7ac975267fa171c63725a57.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/5b40b147e38a3a0f82060926ef709f0d.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/69c8725aeee1dd2b85288075ff6c51b8.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/638db178bbb5d646eddb6410c6f7c64c.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/3f74b6d20383926333d9924950e12e82.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/9483e5aaf72a6dd00628b353db4ec966.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/6ea44f11fd5968929f40c0e8999dcc6d.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/4456393c90330f0c13095695ed854aad.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/d73fba74e82d344a99243779ed70e2ac.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/a37cfa24150e6c99e0d8a6b772ad4a6a.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/50095c92fd1f361cdf5e5d0aa203b733.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/e5425b5fab1d56561d3bbb4fb46612c8.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/c7795d199603815165d04ad9d5f7bfd0.png"><meta property="og:image" content="https://cdn.sspai.com/2022/06/17/24bea7e1c6e25629c410476d68209cb2.png"><meta property="og:updated_time" content="2022-07-15T16:00:04.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="「转」创建自己的第一个 Power Automate 工作流，从此繁琐操作是路人"><meta name="twitter:description" content="「转」创建自己的第一个 Power Automate 工作流，从此繁琐操作是路人"><meta name="twitter:image" content="https://cdn.sspai.com/2022/06/17/de8c3fa824294bf25c005ee739b6fa16.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/public/",scheme:"Pisces",sidebar:{position:"left",display:"post",offset:12,offset_float:0,b2t:!1,scrollpercent:!0},fancybox:!0,motion:!0,duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://talengu.github.io/2022/07/15/test/202207/2022-07-06-112955648077/"><title> 「转」创建自己的第一个 Power Automate 工作流，从此繁琐操作是路人 | 一塘</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div> <a href="https://github.com/talengu" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/public/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">一塘</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/public/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-archives"><a href="/public/archives" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 往期</a></li><li class="menu-item menu-item-categories"><a href="/public/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-tags"><a href="/public/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> 搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://talengu.github.io/public/2022/07/15/test/202207/2022-07-06-112955648077/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="一塘"><meta itemprop="description" content><meta itemprop="image" content="https://avatars1.githubusercontent.com/u/10290923?v=3&s=460"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="一塘"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> 「转」创建自己的第一个 Power Automate 工作流，从此繁琐操作是路人</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-07-15T16:00:04+00:00">2022-07-15</time> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <time title="更新于" itemprop="dateModified" datetime="2022-07-15T16:00:04+00:00">2022-07-15</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/public/categories/转载/" itemprop="url" rel="index"><span itemprop="name">转载</span></a></span></span> <span class="post-meta-divider">|</span><span class="page-pv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_page_pv"></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span title="字数统计">4.2k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span title="阅读时长">14</span></div></div></header><div class="post-body" itemprop="articleBody"><p>「转」<a href="https://sspai.com/post/73710" target="_blank" rel="noopener">创建自己的第一个 Power Automate 工作流，从此繁琐操作是路人</a></p><a id="more"></a><p>编注：本文为《<a href="https://sspai.com/series/273" target="_blank" rel="noopener">59 分钟就上手 Power Automate Desktop</a>》栏目的试读文章。可能是少数派目前最具「信价比」的栏目，介绍 Power Automate Desktop 这款能把你从重复繁琐的软件操作中解脱出来的效率工具。欢迎前往<a href="https://sspai.com/series/273" target="_blank" rel="noopener">详情页</a>了解栏目的具体内容。</p><p>点击<a href="https://www.jianguoyun.com/p/DRKZb7gQyODhBxjdw8sEIAA" target="_blank" rel="noopener">链接</a>，下载文章中演示时所用到的文件。</p><p>在上一篇文章中，我帮助大家厘清了通过 Power Automate Desktop（下文简称 PAD） 来解决问题的基本思路，那就是「抽象问题 &gt; 确定目标</p><blockquote><p>思考解决方案 &gt; 在 PAD 中实现」。同时，我们也简单地了解了 PAD 的工作区以及「数据」「变量」「控制结构」这些概念，通过掌握这些最基础的元素我们已经可以在 PAD 上创建一些简单的流了。</p></blockquote><p>那么，在第二节课程中我会带着大家一步步地创建一个流，通过这个案例让大家快速上手 PAD 的基本操作。另外，在本节课的最后我还为大家准备一份 PAD 的调试指南，可以帮助大家利用一些基本原则来快速定位 bug 以及解决 bug。</p><h2 id="流（Flow）是什么？"><a class="header-anchor" href="#流（Flow）是什么？">¶</a>流（Flow）是什么？</h2><p>流（Flow）是 PAD 中工作流的基本度量单位，一个流即是一系列操作的一个组合。在 PAD 的主界面中，我们看到的就是一个流列表，列表中的每一个项目都包含了流的名称、最近一次修改时间和状态。如果选中任意一个流，就会出现快速操作栏，在这里我可以对选中的流进行运行、停止以及编辑等操作。</p><p><img src="https://cdn.sspai.com/2022/06/17/de8c3fa824294bf25c005ee739b6fa16.png" alt></p><p>在 PAD 里帮你完整解决一个问题的流程就是流，至于流是简单还是复杂，那就丰俭由人。用 PAD 逐个打开京东、淘宝的网址，这个操作可以是流；用 PAD 打开商品网址后，复制标题和价格到 Excel，这个操作可以是流；用 PAD 打开商品网址后，复制标题和价格到 Excel，然后把 Excel 作为附件发送给自己，同时抄送给同事，这个操作也可以是流。因此，一个流中的动作数量和复杂程度没有任何限制，只要这个流可以解决预想中的问题，就可以称之为一个完整的流。</p><h2 id="怎样创建自己的流"><a class="header-anchor" href="#怎样创建自己的流">¶</a>怎样创建自己的流</h2><h3 id="验证需求"><a class="header-anchor" href="#验证需求">¶</a>验证需求</h3><p>一个 PAD 的流从创建、调试到最终可用，都需要时间和精力去实现，这本身也是一种成本。而发明工具的最终目的还是要提高效率、解决问题，因此在动手创建流之前可以先想一想：</p><ul><li>这项工作是周期性的吗？</li><li>PAD 能为我节省多少时间？</li><li>根据工作的复杂程度，我想要完成创建一个流需要多长时间？</li></ul><p>比如现在你需要把 10 份 Word 文档中的数据汇总到同一个 Excel 中，这份工作可能几个月才需要做一次。这种情况下，用 PAD 去编写一个流就非常不划算。但如果你每天、每周都需要做同样的汇总操作，手工复制粘贴就应该被机器来替代了，节省的时间累积下来会非常可观。</p><p>如上文的例子所述，如果评估完成本和收益后还是觉得使用 PAD 更划算，那我们再来认真学习如何创建一个流也不迟。</p><h3 id="三步定位"><a class="header-anchor" href="#三步定位">¶</a>三步定位</h3><p>上文提到过，我们可以把 PAD 理解成一种编程工具，而利用编程工具解决问题可以分为三步：</p><ul><li>抽象问题，确定目标</li><li>找出解决方案</li><li>翻译成机器看的懂的语言</li></ul><p>那么把这个流程应用到 PAD 上，就可以得到如下步骤：</p><ul><li>把自己要优化的流程手动多跑几遍，想清楚过程中自己的鼠标键盘做了什么操作，使用了软件内的什么功能，对流程中各处的情况有个基本的认知。</li><li>画出整个流程的「流程图」。如果工作流比较复杂，可以把工作流切分成不同的模块。前期对 PAD 了解不多的时候，可以抽象的层次放得更低一些，甚至到每一个具体的步骤。这里的「流程图」其实就是把整个流程拆成几个不同的模块并用箭头连接一下，方便逐个击破。</li><li>参照流程图分模块拼接流并调试。用 PAD 创建流的时候多想想人工操作在这一步会怎么做，然后再看怎么用 PAD 实现它。</li></ul><h2 id="案例演示"><a class="header-anchor" href="#案例演示">¶</a>案例演示</h2><p>假如说我有一个需求：给定一批京东商品的网址，逐个在浏览器上访问，然后截图保留快照到本地文件夹，最后把文件夹打包压缩。</p><pre><code>https://item.jd.com/100008716820.html
https://item.jd.com/100001644698.html
https://item.jd.com/100015047660.html
</code></pre><p>按照上面说的三部定位法，我先想清楚这个问题需要怎么来解决，然后构思一个流程图，最后就是分模块构建，完成后再进行拼接。</p><p><img src="https://cdn.sspai.com/2022/06/17/e72489a744d32d7ee2c1d05c33c99750.png" alt></p><h3 id="明确流程"><a class="header-anchor" href="#明确流程">¶</a>明确流程</h3><p>这里的需求相对简单，多体验几次就可以直接生成下面这份流程图。我们大致可以将这个流程分为两个部分：Excel 读取、浏览器循环打开网址并截图。</p><p><img src="https://cdn.sspai.com/2022/06/17/ff2858560d6a1910cbe192c22f5ea5b0.png" alt></p><h3 id="分模块拼接"><a class="header-anchor" href="#分模块拼接">¶</a>分模块拼接</h3><h4 id="从获取商品网址列表"><a class="header-anchor" href="#从获取商品网址列表">¶</a>从获取商品网址列表</h4><p>首先我们需要做的是把相关的商品网址从 Excel 中提取出来。人工操作的时候，流程是「打开 Excel-选中所有 item - 复制」。我们希望这个流通用性更强，因为每次 Excel 中的 <strong>商 品的数量应该是不确定的</strong>。那我们该怎样确保每次都能选中所有的商品网址列表？</p><p><img src="https://cdn.sspai.com/2022/06/17/262d41483b5554d336ceeb7b48bf4737.png" alt></p><p>这时我们就需要想想，在人工操作的时候我们是怎么来确定选中区域的范围的？其实很简单，只要找到文字和空白行交界的地方，从第一行到这里就是该选中的位置。</p><p>所以在 PAD 里面，我们可以先定位出表格里第一个空白行，然后提取表格里面第一行到「第一个空白行-1」范围之间的内容。</p><p><img src="https://cdn.sspai.com/2022/06/17/6cba21a8d0780a742d20350c99fcb0d8.png" alt></p><p>因为不同的模块是靠变量来传递信息的，上一个模块的输出是下一个模块的输入。上一个模块写好了，我们应该检查一下这个模块输出的内容是否满足我们的要求，如果不满足，则下一个模块也无法正常对接运行。</p><p>这里我们希望的输出是一个存放着所有需要遍历的网址列表 <code>ExcelData</code>，所以我们只需要观察在此部分模块结束时，<code>ExcelData</code> 中的数据是否符合我们的需求即可。</p><p>点击「运行」，等待流执行完成。完成后在「流变量」区域点击 <code>ExcelData</code>，发现数据类型的确是「数据表」，并且表中存放着需要遍历的所有网址，这就代表着这个模块我们已经创建成功了。</p><p><img src="https://cdn.sspai.com/2022/06/17/ef2cc4d9b12be06a30cdcafb348ec208.png" alt></p><h4 id="单条网址打开后截图保存"><a class="header-anchor" href="#单条网址打开后截图保存">¶</a>单条网址打开后截图保存</h4><p>正常来讲，此处应该直接开始编写循环结构，但这样每次调试都需要运行一次之前的步骤，既耗时又增加了调试的复杂度，和我们「分模块拼接」的思想是相悖的。</p><p>因此，在循环这个模块里，我们其实 **只 需要一个存放着网址列表的变量输入。**为了方便下面的调试，可以全选上一个模块的动作，然后在右键菜单中选择「禁用操作」。</p><p><img src="https://cdn.sspai.com/2022/06/17/a991d2d9c0d5881c937bef77110c7fc3.png" alt></p><p>这样一来，我们可以专心先把循环这个模块搞定。循环的本质是把一项工作重复很多遍，那要想写好循环，其实我们只需要把里面的工作搞清楚就行了，也就是---- 给定一个网址，浏览器打开网址并截图保存。我们拿 <code>https://item.jd.com/100008716820.html</code> 举例子。</p><p>首先是用浏览器打开：</p><p><img src="https://cdn.sspai.com/2022/06/17/aa58f992a7ac975267fa171c63725a57.png" alt></p><p>通常浏览器打开一个网址还需要等待网页完全加载，网页加载不全的话截图也没意义，所以我们先人工加载一遍网页，估算网页加载时间大概在 2 秒，保险起见那我们就等 3 秒。</p><p><img src="https://cdn.sspai.com/2022/06/17/5b40b147e38a3a0f82060926ef709f0d.png" alt></p><p>现在网页加载好了，我们该进行截图操作了。PAD 自己提供了三种截图的动作。</p><ul><li>获取屏幕截图：直接在屏幕的可视范围内截图。</li><li>获取网页的屏幕截图：会自动下拉完全网页，是网页的长图。</li><li>获取 UI 元素的屏幕截图：单个元素截图，暂时用不上。</li></ul><p>这里我们选择「获取屏幕截图」这个动作，多显示器的用户可以指定要截取的屏幕，单一屏幕可以直接选「所有屏幕」。</p><p><img src="https://cdn.sspai.com/2022/06/17/69c8725aeee1dd2b85288075ff6c51b8.png" alt></p><p>我们希望截图能够以文件的形式保存，那么就需要指定一个本地路径。这里的本地路径可以在目标文件夹内随意复制一个文件的地址后粘贴进来，然后修改最后的文件名和文件后缀。等截图完了，我们就可以关闭浏览器。</p><p><img src="https://cdn.sspai.com/2022/06/17/638db178bbb5d646eddb6410c6f7c64c.png" alt></p><p>当循环里的任务编写完后也需要做一次检查，点击「运行」看看目标文件夹内是否生成了对应的屏幕截图。</p><h4 id="编写循环任务"><a class="header-anchor" href="#编写循环任务">¶</a>编写循环任务</h4><p>我们现在尝试把单项任务放到循环里面。</p><p>首先，我们需要一个列表作为循环的输入。按照「分模块调试」的思想，我们应该另外创建一个存放网址的列表作为模块测试的输入源，避免前方动作耗时太长而降低模块测试的效率。不过，在这个案例中前方的动作数量较少，耗时不多，所以权且直接启用上一个模块的输出作为循环模块的输入。</p><p>接着，我们对 <code>ExcelData</code> 进行「for each」循环，每次循环到的网址储存到 <code>CurrentItem</code> 里面。</p><p><img src="https://cdn.sspai.com/2022/06/17/3f74b6d20383926333d9924950e12e82.png" alt></p><p>因为循环里每次打开的网址不同，所以我们需要将原来固定的网址 <code>https://item.jd.com/100008716820.html</code> 变更为每次循环里的网址变量 <code>CurrentItem</code></p><p>点击「运行」，我们来看看是否这个模块按照我们的期望输出了三个商品的截图。很遗憾，没有。文件夹最后只有一张截图，这是因为我们所有的截图文件都采用了同一个文件名，每次新的截图把前一个覆盖直接掉了。</p><p>因此，我们需要让不同的截图拥有不同的名字。方法有很多，这里我想用网址中的数字编号来做唯一的匹配符。从网址里获取第 20 个字符后 12 个字符长度的内容，赋值为<code>ItemID</code>，然后放入图片的保存路径。</p><p><img src="https://cdn.sspai.com/2022/06/17/9483e5aaf72a6dd00628b353db4ec966.png" alt><img src="https://cdn.sspai.com/2022/06/17/6ea44f11fd5968929f40c0e8999dcc6d.png" alt></p><p>此时再运行一次，就可以发现文件夹里成功包含了三张商品的截图。</p><p><img src="https://cdn.sspai.com/2022/06/17/4456393c90330f0c13095695ed854aad.png" alt></p><h4 id="优化步骤"><a class="header-anchor" href="#优化步骤">¶</a>优化步骤</h4><p>虽然运行成功了，但是我们也能发现每次打开浏览器然后关闭太耗时。当循环次数少时尚能接受，次数增多后则非常难熬。</p><p>与开启关闭浏览器相比，在开启的浏览器中跳转新网址则会快很多，所以我们可以在循环外开启和关闭浏览器，循环内只完成不同网址的跳转。</p><p><img src="https://cdn.sspai.com/2022/06/17/d73fba74e82d344a99243779ed70e2ac.png" alt></p><h4 id="打包文件夹"><a class="header-anchor" href="#打包文件夹">¶</a>打包文件夹</h4><p>打包压缩这一步很简单，PAD 有成熟的动作，拖进工作区填表即可。</p><p><img src="https://cdn.sspai.com/2022/06/17/a37cfa24150e6c99e0d8a6b772ad4a6a.png" alt></p><h2 id="调试的方法"><a class="header-anchor" href="#调试的方法">¶</a>调试的方法</h2><p>在编写流的过程中，通常很难一次就直接跑通，多半都会遇到各种问题（Bug）。处理 Bug 经常会占整体编写时间的一半以上，那怎样相对高效地处理 Bug 呢？</p><p>很不幸，正因为 Bug 是意料之外的，所以我也很难直接告诉你一个框架性的处理 Bug 的流程。不过处理 Bug 可以拆成找 Bug 和解决 Bug 两个环节，还是有一些基本的原则可以帮助你事半功倍。</p><h3 id="找-Bug"><a class="header-anchor" href="#找-Bug">¶</a>找 Bug</h3><p>通常我们运行一个流，它报错时会直接提示你是在第几个操作上出了什么问题，这个时候你可以直接点开对应的操作看看是不是自己配置上出了什么错误。</p><p>比如下图的「提示-图像不存在」，原因在于我们的文件路径少了文件后缀，即文件的路径应该是 <code>D:\我的坚果云\常用模块案例\04-批量提取身份证信息\身份证图片集\身份证.png</code> ，而不是 <code>D:\我的坚果云\常用模块案例\04-批量提取身份证信息\身份证图片集\身份证</code> 。</p><p><img src="https://cdn.sspai.com/2022/06/17/50095c92fd1f361cdf5e5d0aa203b733.png" alt></p><h4 id="设置断点"><a class="header-anchor" href="#设置断点">¶</a>设置断点</h4><p>简单的配置错误其实通过报错的信息就可以解决，但有时候我们会发现报错提示的操作的配置并没有问题，这就说明问题出在更前面的操作里。</p><p>这个时候我们可以通过设置断点，流运行到断点就会自动停止，只有我们点击「运行下一个操作」流才会继续往下运行，然后通过在变量区观察断点操作前后变量值的变化，就可以验证断点处的操作是否符合我们的要求。</p><h4 id="拆分模块"><a class="header-anchor" href="#拆分模块">¶</a>拆分模块</h4><p>在写一些比较复杂的流时，可能涉及到多个软件，以及数百个操作。这个时候如果想要验证的操作是第 80 个，那从头开始运行就会很耗时。</p><p>另外，调试的时候经常会运行数十次才能找到问题，如果每次都需要前面的操作运行几分钟，那整个调试的效率就会非常低。</p><p>这种场景下我会更建议大家将一个复杂的流拆成几个模块（通常是根据不同的软件），上一个模块的输出就是下一个模块的输入。然后除了测试模块，其他模块全部禁用，在测试模块前手动设置测试模块里所需变量的值，观察测试模块的输出是否符合预期。</p><h3 id="解决-Bug"><a class="header-anchor" href="#解决-Bug">¶</a>解决 Bug</h3><p>通常我们定位到 Bug 以后，整个问题其实就解决了一半。解决 Bug 的方法核心其实就是查文档、搜索然后不断修改验证。</p><p>PAD 中的每一个操作微软都提供了一个参考文档，可以点击「详细信息」快速直达。对照文档，可以看看自己的配置是否存在问题。</p><p><img src="https://cdn.sspai.com/2022/06/17/e5425b5fab1d56561d3bbb4fb46612c8.png" alt></p><p>如果不是配置上的问题，那可以直接把报错信息复制到浏览器里查询，看看网络上有没有相关的解决方案。不过目前互联网上 PAD 的中文内容还是比较少，所以搜索时建议使用英文会得到更多相关的结果。</p><h3 id="PAD-自身的出错处理"><a class="header-anchor" href="#PAD-自身的出错处理">¶</a>PAD 自身的出错处理</h3><p>PAD 里任意一个操作下方其实都有一个「出错时」的配置选项，比如第一次出错后间隔一定时间自动重试，或者忽略错误继续流的运行，这其实也是一个帮助我们应对 Bug 的地方。</p><p><img src="https://cdn.sspai.com/2022/06/17/c7795d199603815165d04ad9d5f7bfd0.png" alt></p><p>另一个方法是我们可以设置一个 <code>Warning</code> 变量存放我们想要观察的变量值，然后通过调用子流来输出。这个触发条件可以是报错就触发，也可以指定特定报错类型才触发。</p><p><img src="https://cdn.sspai.com/2022/06/17/24bea7e1c6e25629c410476d68209cb2.png" alt></p><h2 id="小结"><a class="header-anchor" href="#小结">¶</a>小结</h2><p>在本节课程中，我带着大家非常详细地创建了 PAD 上的第一个流，从验证需求开始，到明确流程，接着分模块把具体的操作动作编写完成，最后拼接成一个完整的流。在创建第一个流之后，我还向大家介绍了一些基本的 bug 调试方法，可以在最快的时间内找到并解决问题。当然话说回来，处理 Bug 终究不是一个标准化的过程，很多经验还是需要不断实践来积累。从下一节课开始，我将逐个介绍操作中的各个模块和动作，并辅以对应的实战案例，希望通过这些例子可以帮助大家在较短的时间内掌握这些模块，以应用到日常的流创作中。</p></div><div></div><div></div><div></div><footer class="post-footer"><div class="post-tags"> <a href="/public/tags/转载/" rel="tag"># 转载</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/public/2022/07/15/test/202207/2022-07-10-013640114938/" rel="next" title="「转」当飞盘成为人类的玩具，我们该如何参与这场游戏"><i class="fa fa-chevron-left"></i> 「转」当飞盘成为人类的玩具，我们该如何参与这场游戏</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/public/2022/07/15/test/202207/2022-07-03-010835583781/" rel="prev" title="「转」白板与笔记融合：我的四个氢图使用场景">「转」白板与笔记融合：我的四个氢图使用场景<i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="gitalk-container"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview"> 站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="https://avatars1.githubusercontent.com/u/10290923?v=3&s=460" alt="一塘"><p class="site-author-name" itemprop="name">一塘</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/public/archives"><span class="site-state-item-count">56</span> <span class="site-state-item-name">博客</span></a></div><div class="site-state-item site-state-categories"> <a href="/public/categories/index.html"><span class="site-state-item-count">49</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/public/tags/index.html"><span class="site-state-item-count">117</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/public/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/talengu" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="/public/2015/01/01/About" target="_blank" title="About"><i class="fa fa-fw fa-globe"></i> About</a></span></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#流（Flow）是什么？"><span class="nav-text">¶流（Flow）是什么？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#怎样创建自己的流"><span class="nav-text">¶怎样创建自己的流</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#验证需求"><span class="nav-text">¶验证需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三步定位"><span class="nav-text">¶三步定位</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#案例演示"><span class="nav-text">¶案例演示</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#明确流程"><span class="nav-text">¶明确流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分模块拼接"><span class="nav-text">¶分模块拼接</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#从获取商品网址列表"><span class="nav-text">¶从获取商品网址列表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#单条网址打开后截图保存"><span class="nav-text">¶单条网址打开后截图保存</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#编写循环任务"><span class="nav-text">¶编写循环任务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#优化步骤"><span class="nav-text">¶优化步骤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#打包文件夹"><span class="nav-text">¶打包文件夹</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#调试的方法"><span class="nav-text">¶调试的方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#找-Bug"><span class="nav-text">¶找 Bug</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#设置断点"><span class="nav-text">¶设置断点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#拆分模块"><span class="nav-text">¶拆分模块</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#解决-Bug"><span class="nav-text">¶解决 Bug</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PAD-自身的出错处理"><span class="nav-text">¶PAD 自身的出错处理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#小结"><span class="nav-text">¶小结</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2015 - <span itemprop="copyrightYear">2022</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">一塘</span></div><div class="timemark"> <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span><script>var now=new Date;function createtime(){var n=new Date("01/01/2015 17:38:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="本站已运行 "+dnum+" 天 ",document.getElementById("times").innerHTML=hnum+" 小时 "+mnum+" 分 "+snum+" 秒"}setInterval("createtime()",250)</script></div><div class="powered-by"> 由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动</div><div class="theme-info"> 主题 - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a></div><div class="busuanzi-count"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span><span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/public/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/public/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/public/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/public/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/public/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/public/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/public/js/src/utils.js?v=5.1.0"></script><script type="text/javascript" src="/public/js/src/motion.js?v=5.1.0"></script><script type="text/javascript" src="/public/js/src/affix.js?v=5.1.0"></script><script type="text/javascript" src="/public/js/src/schemes/pisces.js?v=5.1.0"></script><script type="text/javascript" src="/public/js/src/scrollspy.js?v=5.1.0"></script><script type="text/javascript" src="/public/js/src/post-details.js?v=5.1.0"></script><script type="text/javascript" src="/public/js/src/bootstrap.js?v=5.1.0"></script><link rel="stylesheet" href="//cdn.bootcss.com/gitalk/1.6.2/gitalk.min.css"><script src="//cdn.bootcss.com/gitalk/1.6.2/gitalk.min.js"></script><script type="text/javascript">var gitalk=new Gitalk({clientID:"315ada12fed7a0ffb6b7",clientSecret:"5f15e644005fabee93cc7f50d70c78c57dce0e86",repo:"talengu.github.io",owner:"talengu",admin:["talengu"],id:location.pathname,labels:["Gitalk"],perPage:15,pagerDirection:"last",createIssueManually:!0,distractionFreeMode:!1,proxy:"https://gitalk.talengu.workers.dev/?https://github.com/login/oauth/access_token"});gitalk.render("gitalk-container")</script><script type="text/javascript">var isfetched=!1,search_path="search.xml";0==search_path.length&&(search_path="search.xml");var path="/public/"+search_path;function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".popup").toggle()}var searchFunc=function(e,c,s){"use strict";$.ajax({url:e,dataType:"xml",async:!0,success:function(e){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var t=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),a=document.getElementById(c),r=document.getElementById(s);a.addEventListener("input",function(){var u=0,d='<ul class="search-result-list">',f=this.value.trim().toLowerCase().split(/[\s\-]+/);r.innerHTML="",1<this.value.trim().length&&t.forEach(function(e){var a=!1,r=e.title.trim().toLowerCase(),c=e.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),t=decodeURIComponent(e.url),s=-1,o=-1,n=-1;if(""!=r&&f.forEach(function(e,t){s=r.indexOf(e),o=c.indexOf(e),(0<=s||0<=o)&&(a=!0,0==t&&(n=o))}),a){u+=1,d+="<li><a href='"+t+"' class='search-result-title'>"+r+"</a>";var i=e.content.trim().replace(/<[^>]+>/g,"");if(0<=n){var l=n-20,p=n+80;l<0&&(l=0),0==l&&(p=50),p>i.length&&(p=i.length);var h=i.substring(l,p);f.forEach(function(e){var t=new RegExp(e,"gi");h=h.replace(t,'<b class="search-keyword">'+e+"</b>")}),d+='<p class="search-result">'+h+"...</p>"}d+="</li>"}}),d+="</ul>",0==u&&(d='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'),""==f&&(d='<div id="no-result"><i class="fa fa-search fa-5x" /></div>'),r.innerHTML=d}),proceedsearch()}})};$(".popup-trigger").click(function(e){e.stopPropagation(),0==isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(function(e){$(".popup").hide(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")}),$(".popup").click(function(e){e.stopPropagation()})</script><script type="text/javascript" src="/public/js/src/clipboard.min.js"></script><script type="text/javascript" src="/public/js/src/clipboard-use.js"></script></body></html>